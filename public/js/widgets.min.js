var custom_upload_frame_obj;jQuery(document).ready(function(a){function i(e){e.find(".wh-color-picker").wpColorPicker({change:_.throttle(function(){a(this).trigger("change")},3e3)})}a(document).on("click","input.wh-image-picker",function(e){var s=a(this);e.preventDefault();var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"custom-state-insert",title:s.data("uploader_title"),allowLocalEdits:!1,displaySettings:!0,displayUserSettings:!1,multiple:!1,library:wp.media.query({type:"image"})},wp.media.controller.Library.prototype.defaults)});(custom_upload_frame_obj=wp.media.frames.custom_upload_frame_obj=wp.media({button:{text:a(this).data("uploader_button_text")},state:"custom-state-insert",states:[new t],multiple:!1})).on("select",function(){var e=custom_upload_frame_obj.state("custom-state-insert"),t=e.get("selection"),i=e.display(t.first()).toJSON(),a=t.first().toJSON(),i=wp.media.string.props(i,a),o=s.siblings(".image-field-hidden"),n=i.src;o.val(n),o.trigger("change");var r='<img src="'+n+'" />';s.siblings(".field-image-preview").html(r),s.siblings(".btn-image-remove").css("display","inline-block")}),custom_upload_frame_obj.open()}),a(document).on("click","input.btn-image-remove",function(e){e.preventDefault();var t=a(this),i=t.siblings(".image-field-hidden");i.val(""),t.siblings(".field-image-preview").html(""),t.css("display","none"),i.trigger("change")}),a(document).on("widget-added widget-updated",function(e,t){i(t)}),a(document).ready(function(){a("#widgets-right .widget:has(.wh-color-picker)").each(function(){i(a(this))})})});