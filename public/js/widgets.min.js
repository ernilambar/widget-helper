var custom_upload_frame_obj;jQuery(document).ready(function($){function initWHColorPicker(widget){widget.find(".wh-color-picker").wpColorPicker({change:_.throttle(function(){$(this).trigger("change")},3e3)})}$(document).on("click","input.wh-image-picker",function(event){var $this=$(this);event.preventDefault();var customImageObject=wp.media.controller.Library.extend({defaults:_.defaults({id:"custom-state-insert",title:$this.data("uploader_title"),allowLocalEdits:!1,displaySettings:!0,displayUserSettings:!1,multiple:!1,library:wp.media.query({type:"image"})},wp.media.controller.Library.prototype.defaults)});(custom_upload_frame_obj=wp.media.frames.custom_upload_frame_obj=wp.media({button:{text:$(this).data("uploader_button_text")},state:"custom-state-insert",states:[new customImageObject],multiple:!1})).on("select",function(){var state=custom_upload_frame_obj.state("custom-state-insert"),selection=state.get("selection"),display=state.display(selection.first()).toJSON(),object_attachment=selection.first().toJSON();display=wp.media.string.props(display,object_attachment);var image_field=$this.siblings(".image-field-hidden"),image_url=display.src;image_field.val(image_url),image_field.trigger("change");var image_html='<img src="'+image_url+'" />';$this.siblings(".field-image-preview").html(image_html),$this.siblings(".btn-image-remove").css("display","inline-block")}),custom_upload_frame_obj.open()}),$(document).on("click","input.btn-image-remove",function(e){e.preventDefault();var $this=$(this),image_field=$this.siblings(".image-field-hidden");image_field.val(""),$this.siblings(".field-image-preview").html(""),$this.css("display","none"),image_field.trigger("change")}),$(document).on("widget-added widget-updated",function(event,widget){initWHColorPicker(widget)}),$(document).ready(function(){$("#widgets-right .widget:has(.wh-color-picker)").each(function(){initWHColorPicker($(this))})})});